# ğŸš€ HÆ°á»›ng dáº«n Deploy lÃªn Railway (Chi tiáº¿t tá»«ng bÆ°á»›c)

## âš ï¸ QUAN TRá»ŒNG: Railway V2 Changes

Railway V2 sá»­ dá»¥ng biáº¿n mÃ´i trÆ°á»ng **KHÃ”NG CÃ“ UNDERSCORE**:
- âœ… `MYSQLHOST` (Ä‘Ãºng)
- âŒ `MYSQL_HOST` (cÅ©, khÃ´ng dÃ¹ng ná»¯a)

## BÆ°á»›c 1: Táº¡o MySQL Service

1. VÃ o Railway Dashboard: https://railway.app
2. Click **"New Project"** â†’ **"Deploy MySQL"**
3. Äá»£i MySQL service khá»Ÿi Ä‘á»™ng (mÃ u xanh)
4. Click vÃ o MySQL service â†’ Tab **"Connect"**
5. Copy láº¡i thÃ´ng tin (Ä‘á»ƒ backup):
   - Host
   - Port
   - User
   - Password
   - Database

## BÆ°á»›c 2: Deploy Node.js App

1. Trong cÃ¹ng project, click **"+ New"** â†’ **"GitHub Repo"**
2. Authorize GitHub náº¿u cáº§n
3. Chá»n repository: `youngestwall/web_blog_up`
4. Railway tá»± Ä‘á»™ng detect Node.js vÃ  deploy
5. Äá»£i deployment xong (mÃ u xanh)

## BÆ°á»›c 3: Link MySQL vá»›i App (BÆ¯á»šC QUAN TRá»ŒNG NHáº¤T!)

### CÃ¡ch 1: DÃ¹ng Service Reference (Khuyáº¿n nghá»‹ â­)

1. Click vÃ o **Node.js service** (web_blog_up)
2. VÃ o tab **"Variables"**
3. Click **"+ New Variable"** â†’ **"Add Reference"**
4. Chá»n **MySQL service** tá»« dropdown
5. Railway tá»± Ä‘á»™ng thÃªm:
   - `MYSQLHOST`
   - `MYSQLPORT`
   - `MYSQLUSER`
   - `MYSQLPASSWORD`
   - `MYSQLDATABASE`

### CÃ¡ch 2: ThÃªm thá»§ cÃ´ng (náº¿u CÃ¡ch 1 khÃ´ng work)

VÃ o tab **"Variables"** cá»§a Node.js service, thÃªm tá»«ng biáº¿n:

```
MYSQLHOST=<copy tá»« MySQL Connect tab>
MYSQLPORT=3306
MYSQLUSER=root
MYSQLPASSWORD=<copy tá»« MySQL Connect tab>
MYSQLDATABASE=railway
```

**LÆ°u Ã½**: Railway V2 dÃ¹ng `MYSQLHOST` khÃ´ng pháº£i `MYSQL_HOST`!

## BÆ°á»›c 4: ThÃªm biáº¿n PORT (náº¿u cáº§n)

Railway tá»± Ä‘á»™ng set PORT, nhÆ°ng náº¿u cáº§n custom:

1. VÃ o **"Variables"** tab
2. ThÃªm: `PORT=8080`

## BÆ°á»›c 5: Khá»Ÿi táº¡o Database

CÃ³ 2 cÃ¡ch:

### CÃ¡ch 1: DÃ¹ng Railway Query Editor

1. Click vÃ o **MySQL service**
2. VÃ o tab **"Query"**
3. Copy ná»™i dung file `schema.sql`
4. Paste vÃ  cháº¡y

### CÃ¡ch 2: DÃ¹ng script setup-db.js (Local)

```bash
# TrÃªn mÃ¡y local, update .env vá»›i thÃ´ng tin Railway
# Sau Ä‘Ã³ cháº¡y:
node setup-db.js
```

## BÆ°á»›c 6: Deploy láº¡i (náº¿u cáº§n)

Railway tá»± Ä‘á»™ng redeploy khi cÃ³ thay Ä‘á»•i, hoáº·c:

1. VÃ o **"Deployments"** tab
2. Click **"Redeploy"**

## âœ… Kiá»ƒm tra

Sau khi deploy xong:

1. Click vÃ o **"Domains"** Ä‘á»ƒ láº¥y URL
2. Truy cáº­p URL: `https://your-app.railway.app`
3. Kiá»ƒm tra logs: Tab **"Logs"** Ä‘á»ƒ xem káº¿t ná»‘i database

## ğŸ› Troubleshooting

### Lá»—i: ECONNREFUSED

- **NguyÃªn nhÃ¢n**: ChÆ°a link MySQL service vá»›i app
- **Giáº£i phÃ¡p**: LÃ m láº¡i BÆ°á»›c 3

### Lá»—i: Cannot find module

- **NguyÃªn nhÃ¢n**: Dependencies chÆ°a cÃ i
- **Giáº£i phÃ¡p**: Railway tá»± Ä‘á»™ng cháº¡y `npm install`, kiá»ƒm tra logs

### Lá»—i: Table doesn't exist

- **NguyÃªn nhÃ¢n**: ChÆ°a cháº¡y schema.sql
- **Giáº£i phÃ¡p**: LÃ m BÆ°á»›c 5

## ğŸ“ Biáº¿n mÃ´i trÆ°á»ng trÃªn Railway

Railway sáº½ tá»± Ä‘á»™ng inject (khi link service):

```
MYSQL_HOST=mysql.railway.internal
MYSQL_PORT=3306
MYSQL_USER=root
MYSQL_PASSWORD=<auto-generated>
MYSQL_DATABASE=railway
PORT=<auto-assigned>
```

Code Ä‘Ã£ Ä‘Æ°á»£c config Ä‘á»ƒ Æ°u tiÃªn dÃ¹ng `MYSQL_*` variables cá»§a Railway!

## ğŸ”— Links há»¯u Ã­ch

- Railway Dashboard: https://railway.app/dashboard
- Railway Docs: https://docs.railway.app
- GitHub Repo: https://github.com/youngestwall/web_blog_up
